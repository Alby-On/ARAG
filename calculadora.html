<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <style>
    /* --- 1. VARIABLES Y RESET --- */
    :root {
        --primary: #1D84CF;
        --secondary: #1A1A1A;
        --accent: #FFB800;
        --light: #f8fafc;
        --white: #ffffff;
        --grad: linear-gradient(135deg, #1D84CF 0%, #0a4d7a 100%);
        --shadow: 0 15px 35px rgba(0, 0, 0, 0.08);
        --transition: all 0.4s cubic-bezier(0.165, 0.84, 0.44, 1);
    }

    body { 
        font-family: 'Open Sans', 'Segoe UI', sans-serif; 
        margin: 0; 
        padding-top: 105px; /* Espacio para la navbar fija */
        background-color: var(--light); 
        color: var(--secondary);
    }

    *, *::before, *::after { box-sizing: border-box; }

    /* --- 2. NAVEGACI√ìN (NAVBAR) --- */
    .navbar {
        background: rgba(255, 255, 255, 0.9);
        backdrop-filter: blur(20px);
        -webkit-backdrop-filter: blur(20px);
        padding: 0 8%;
        display: flex;
        justify-content: space-between;
        align-items: center;
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 85px;
        z-index: 3000;
        box-shadow: 0 2px 20px rgba(0, 0, 0, 0.05);
    }

    .logo img { height: 50px; }

    .nav-links {
        display: flex;
        gap: 30px;
        list-style: none;
        align-items: center;
        margin: 0;
    }

    .nav-links a {
        text-decoration: none;
        color: var(--secondary);
        font-weight: 700;
        text-transform: uppercase;
        font-size: 0.85rem;
        letter-spacing: 1px;
        transition: var(--transition);
    }

    .nav-links a:hover { color: var(--primary); }

    .btn-nav {
        background: var(--grad);
        color: white !important;
        padding: 10px 20px;
        border-radius: 50px;
    }

    .menu-toggle {
        display: none;
        background: none;
        border: none;
        cursor: pointer;
        font-size: 1.8rem;
        color: var(--secondary);
    }

    /* --- 3. CONTENEDORES Y TABLAS --- */
    .container { 
        max-width: 1150px; 
        margin: 20px auto; 
        background: white; 
        padding: 25px; 
        border-radius: 12px; 
        box-shadow: var(--shadow); 
    }
    
    h2 { 
        color: var(--secondary); 
        text-align: center; 
        border-bottom: 3px solid var(--accent); 
        padding-bottom: 10px; 
        font-weight: 800; 
        text-transform: uppercase; 
    }
    
    table { width: 100%; border-collapse: collapse; margin-top: 20px; }
    th, td { border: 1px solid #eee; padding: 12px; text-align: center; }
    
    th { 
        background: var(--grad); 
        color: white; 
        text-transform: uppercase; 
        font-size: 0.85rem; 
        letter-spacing: 1px; 
    }
    
    .total-row { background-color: #f1f8fe; font-weight: bold; color: var(--primary); font-size: 1.1em; }

    /* --- 4. BOTONES --- */
    .btn-add { 
        background: var(--accent); 
        color: var(--secondary); 
        padding: 10px 15px; 
        border: none; 
        border-radius: 5px; 
        cursor: pointer; 
        font-weight: bold; 
        margin-bottom: 15px; 
        transition: var(--transition); 
    }
    .btn-add:hover { background: #f1a100; transform: translateY(-2px); }
    
    .btn-del { background: #f44336; color: white; border: none; padding: 5px 10px; border-radius: 3px; cursor: pointer; }

    .btn-next, .btn-siguiente-paso, .btn-finalizar {
        background: var(--accent);
        color: var(--secondary);
        border: none;
        padding: 15px 40px;
        font-size: 1.1em;
        font-weight: 800;
        border-radius: 50px;
        cursor: pointer;
        text-transform: uppercase;
        transition: var(--transition);
        display: block;
        margin: 25px auto 0;
        box-shadow: 0 10px 20px rgba(255, 184, 0, 0.2);
    }

    .btn-finalizar, .btn-next:not(.naranjo) {
        background: var(--grad);
        color: white;
    }

    .btn-next:hover, .btn-siguiente-paso:hover {
        background: #f1a100;
        box-shadow: 0 10px 25px rgba(255, 184, 0, 0.4);
    }

    /* --- 5. RESUMEN CARDS Y FORMULARIO --- */
    .resumen-container { display: flex; gap: 20px; margin-top: 30px; justify-content: space-between; }
    
    .resumen-card {
        flex: 1;
        background: white;
        padding: 20px;
        border-radius: 15px;
        text-align: center;
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.05);
        border-top: 5px solid var(--primary); 
    }

    .resumen-card.highlight { border-top: 5px solid var(--accent); background: #fffcf4; }

    .resumen-valor { font-size: 2.2em; font-weight: 800; color: var(--secondary); }
    .resumen-card.highlight .resumen-valor { color: var(--primary); }

    .formulario-container {
        background: var(--grad);
        padding: 30px;
        border-radius: 15px;
        margin-top: 40px;
        color: white;
    }

    .form-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px; margin-top: 20px; }
    
    input, select { width: 100%; padding: 12px; border-radius: 8px; border: 1px solid #ddd; font-size: 1em; }

    /* --- 6. MEDIA QUERIES --- */
    @media (max-width: 1024px) {
        .menu-toggle { display: block; }
        .nav-links {
            display: none;
            flex-direction: column;
            position: absolute;
            top: 85px;
            left: 0;
            width: 100%;
            background-color: white;
            padding: 20px 0;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }
        .nav-links.active { display: flex; }
        .nav-links li { margin: 15px 0; text-align: center; }
    }

    @media (max-width: 768px) {
        .resumen-container { flex-direction: column; }
        .container { margin: 10px; padding: 15px; }
    }
</style>
</head>
<nav class="navbar">
    <a href="index.html" class="logo">
        <img src="aragspa.png" alt="Logo ARAG SPA Ingenier√≠a">
    </a>
    <ul class="nav-links">
        <li><a href="index.html#inicio">Inicio</a></li>
        <li><a href="index.html#nosotros">Qui√©nes Somos</a></li>
        <li><a href="index.html#servicios">Servicios</a></li>
        <li><a href="index.html#clientes">Clientes</a></li>
        <li><a href="index.html#por-que-elegirnos">¬øPor qu√© nosotros?</a></li>
        <li><a href="calculadora.html" style="color: var(--accent); font-weight: 800;">Calculadora Solar</a></li>
        <li><a href="index.html#contacto" class="btn-nav">Contacto</a></li>
    </ul>
</nav>

<nav class="navbar moviles">
    <a href="index.html" class="logo">
        <img src="aragspa.png" alt="Logo ARAG SPA Ingenier√≠a">
    </a>

    <button class="menu-toggle" id="mobile-menu" aria-label="Abrir men√∫">
        <i class="fas fa-bars"></i>
    </button>

    <ul class="nav-links" id="nav-list">
        <li><a href="index.html#inicio">Inicio</a></li>
        <li><a href="index.html#nosotros">Qui√©nes Somos</a></li>
        <li><a href="index.html#servicios">Servicios</a></li>
        <li><a href="index.html#clientes">Clientes</a></li>
        <li><a href="index.html#por-que-elegirnos">¬øPor qu√© nosotros?</a></li>
        <li><a href="calculadora.html" style="color: var(--accent); font-weight: 800;">Calculadora Solar</a></li>
        <li><a href="index.html#contacto" class="btn-nav">Contacto</a></li>
    </ul>
</nav>
<body>

<div class="container">
    <h2>Calculadora de Consumo El√©ctrico</h2>

<table id="calcTable">
    <thead>
        <tr>
            <th>Artefacto El√©ctrico</th>
            <th>N¬∞ Equipos</th>
            <th>Potencia (Watts)</th>
            <th>Tiempo de Uso</th>
            <th>kWh / D√≠a</th>
            <th>kWh / Mes</th>
            <th>Acci√≥n</th>
        </tr>
    </thead>
    <tbody id="tableBody">
        </tbody>
    <tfoot>
        <tr>
            <td colspan="7" style="text-align: left; padding: 15px;">
                <button class="btn-add" onclick="addRow()" style="margin: 0;">+ A√±adir Artefacto</button>
            </td>
        </tr>
        <tr class="total-row">
            <td colspan="4">TOTAL CONSUMO ESTIMADO</td>
            <td id="totalDia">0.000</td>
            <td id="totalMes">0.00</td>
            <td></td>
        </tr>
    </tfoot>
</table>
  <div class="resumen-container">
    <div class="resumen-card">
        <span class="resumen-label">Carga M√°xima de Trabajo</span>
        <div class="resumen-valor"><span id="totalWatts">0</span> <small>W</small></div>
        <p class="resumen-desc">Potencia total instalada</p>
    </div>
    
    <div class="resumen-card highlight">
        <span class="resumen-label">Consumo Diario</span>
        <div class="resumen-valor"><span id="resumenDia">0.00</span> <small>kWh</small></div>
        <p class="resumen-desc">Energ√≠a necesaria por d√≠a</p>
    </div>
    
    <div class="resumen-card">
        <span class="resumen-label">Consumo Mensual</span>
        <div class="resumen-valor"><span id="resumenMes">0.00</span> <small>kWh</small></div>
        <p class="resumen-desc">Energ√≠a total al mes</p>
    </div>
</div>
<div class="formulario-container">
    <h3>Casi listo: Obt√©n tu configuraci√≥n solar</h3>
    <form id="solarLeadForm">
        <div class="form-grid">
            <div class="form-group">
                <label>Tu Regi√≥n:</label>
                <select id="userRegion" required>
                    <option value="" disabled selected>Selecciona tu regi√≥n...</option>
                    <option value="6.5">Arica y Parinacota</option>
                    <option value="6.4">Tarapac√°</option>
                    <option value="6.6">Antofagasta</option>
                    <option value="6.2">Atacama</option>
                    <option value="5.8">Coquimbo</option>
                    <option value="5.2">Valpara√≠so</option>
                    <option value="5.1">Metropolitana de Santiago</option>
                    <option value="4.8">O'Higgins</option>
                    <option value="4.5">Maule</option>
                    <option value="4.2">√ëuble</option>
                    <option value="4.0">Biob√≠o</option>
                    <option value="3.8">La Araucan√≠a</option>
                    <option value="3.5">Los R√≠os</option>
                    <option value="3.2">Los Lagos</option>
                    <option value="2.8">Ays√©n</option>
                    <option value="2.5">Magallanes y la Ant√°rtica Chilena</option>
                </select>
            </div>

            <div class="form-group">
                <label>Potencia Total Instalada:</label>
                <input type="text" id="formWatts" readonly>
            </div>

            <div class="form-group">
                <label>Consumo Mensual:</label>
                <input type="text" id="formKwhMes" readonly>
            </div>
        </div>

        <button type="button" class="btn-next" onclick="nextStep()">Siguiente: Calcular Paneles ‚ûî</button>
    </form>
</div>
<div id="resultadoFinal" class="resultado-propuesta" style="display: none;">
    <h3>üìä Propuesta T√©cnica Estimada</h3>
    <div class="grid-resultados">
        <div class="item-res">
            <span class="tit">Inversor Recomendado</span>
            <span class="val" id="resInversor">0 kW</span>
        </div>
        <div class="item-res">
            <span class="tit">Paneles (Mono-PERC 580W)</span>
            <span class="val" id="resPaneles">0 Unidades</span>
        </div>
        <div class="item-res">
            <span class="tit">Banco de Bater√≠as Litio</span>
            <span class="val" id="resBaterias">0 kWh</span>
        </div>
        <div class="item-res total-costo">
            <span class="tit">Inversi√≥n Estimada (IVA Inc.)</span>
            <span class="val" id="resCosto">$0</span>
        </div>
    </div>
    <p style="font-size: 0.8em; margin-top: 15px; color: #666;">*Valores referenciales sujetos a factibilidad t√©cnica y variaciones de mercado.</p>
</div>
<div id="contactoFinal" class="contacto-container" style="display: none;">
    <h3>üöÄ ¬°Solicita tu Asesor√≠a Personalizada!</h3>
    <p>Ingresa tus datos para que un experto valide tu proyecto.</p>
    
    <form id="leadForm" class="grid-form">
        <div class="field">
            <label>Nombre</label>
            <input type="text" id="nombre" placeholder="Tu nombre" required>
        </div>
        <div class="field">
            <label>Apellido</label>
            <input type="text" id="apellido" placeholder="Tu apellido" required>
        </div>
        <div class="field">
            <label>Tel√©fono</label>
            <input type="tel" id="telefono" placeholder="+56 9 1234 5678" required>
        </div>
        <div class="field">
            <label>Comuna</label>
            <input type="text" id="comuna" placeholder="Ej: Chill√°n" required>
        </div>
        <div class="field full">
            <label>Email</label>
            <input type="email" id="email" placeholder="correo@ejemplo.com" required>
        </div>
        <div class="field full">
            <label>Horario de contacto preferido</label>
            <select id="horario">
                <option value="ma√±ana">Ma√±ana (09:00 - 13:00)</option>
                <option value="tarde">Tarde (14:00 - 18:00)</option>
                <option value="vespertino">Vespertino (18:00 - 21:00)</option>
            </select>
        </div>
        <button type="submit" class="btn-finalizar">Enviar Solicitud y Finalizar</button>
    </form>
</div>

<div id="btnPasoContacto" style="display: none; text-align: center; margin-top: 20px;">
    <button class="btn-siguiente-paso" onclick="mostrarContacto()">Continuar con mi solicitud ‚ûî</button>
</div>
</div>

<script>
    const categorias = {
        "üîå Electrodom√©sticos": {
            "Ampolleta LED": 9, "Ampolleta incandescente": 60, "Televisor LED 32\"": 80,
            "Televisor LED 50\"": 120, "Refrigerador": 150, "Microondas": 1200,
            "Hervidor el√©ctrico": 2000, "Lavadora": 800, "Secadora de ropa": 2500,
            "Aspiradora": 1400, "Plancha": 1200, "Horno el√©ctrico": 2000, "Tostador": 800
        },
        "üíª Electr√≥nica y Oficina": {
            "Notebook": 60, "PC de escritorio": 300, "Monitor LED": 30,
            "Router WiFi": 10, "Impresora": 500, "Cargador celular": 5,
            "Consola de videojuegos": 200, "C√°mara de seguridad": 10
        },
        "üõ†Ô∏è Fuerza y Climatizaci√≥n": {
            "Taladro": 600, "Esmeril angular": 800, "Sierra circular": 1400,
            "Soldadora inverter": 3000, "Compresor de aire peque√±o": 1500,
            "Ventilador": 60, "Estufa el√©ctrica": 2000, "Aire acondicionado 9000 BTU": 900,
            "Aire acondicionado 12000 BTU": 1200, "Bomba de agua 1/2 HP": 750,
            "Bomba de agua 1 HP": 1500, "Port√≥n el√©ctrico": 500
        }
    };

    function addRow() {
        const tbody = document.getElementById('tableBody');
        const row = document.createElement('tr');
        
        // Generar Select de Artefactos
        let artOptions = '<option value="" disabled selected>Seleccione...</option>';
        for (let cat in categorias) {
            artOptions += `<optgroup label="${cat}">`;
            for (let art in categorias[cat]) {
                artOptions += `<option value="${categorias[cat][art]}">${art}</option>`;
            }
            artOptions += `</optgroup>`;
        }

        // Generar Select de Tiempo (Minutos y Horas)
        let timeOptions = '<option value="0" selected>0 min/hrs</option>';
        timeOptions += '<optgroup label="Minutos">';
        timeOptions += '<option value="0.083">5 min</option>';
        timeOptions += '<option value="0.166">10 min</option>';
        timeOptions += '<option value="0.25">15 min</option>';
        timeOptions += '<option value="0.5">30 min</option>';
        timeOptions += '</optgroup>';
        timeOptions += '<optgroup label="Horas">';
        for (let i = 1; i <= 24; i++) {
            timeOptions += `<option value="${i}">${i} hora${i>1?'s':''}</option>`;
        }
        timeOptions += '</optgroup>';

        row.innerHTML = `
            <td><select onchange="updateWatts(this)">${artOptions}</select></td>
            <td><input type="number" value="1" min="1" oninput="calculate(this)"></td>
            <td><input type="number" value="0" oninput="calculate(this)"></td>
            <td><select onchange="calculate(this)">${timeOptions}</select></td>
            <td class="kwh-dia">0.00</td>
            <td class="kwh-mes">0.00</td>
            <td><button class="btn-del" onclick="removeRow(this)">X</button></td>
        `;
        tbody.appendChild(row);
    }

    function updateWatts(selectEl) {
        const row = selectEl.closest('tr');
        const powerInput = row.cells[2].querySelector('input');
        powerInput.value = selectEl.value;
        calculate(powerInput);
    }

    function calculate(el) {
        const row = el.closest('tr');
        const qty = parseFloat(row.cells[1].querySelector('input').value) || 0;
        const watts = parseFloat(row.cells[2].querySelector('input').value) || 0;
        const hours = parseFloat(row.cells[3].querySelector('select').value) || 0;

        const kwhDia = (qty * watts * hours) / 1000;
        const kwhMes = kwhDia * 30;

        row.querySelector('.kwh-dia').innerText = kwhDia.toFixed(3);
        row.querySelector('.kwh-mes').innerText = kwhMes.toFixed(2);

        updateTotals();
    }

function updateTotals() {
    let totalW = 0, totalD = 0, totalM = 0;
    
    // Recorremos las filas para sumar Watts totales y kWh
    document.querySelectorAll('#tableBody tr').forEach(row => {
        const qty = parseFloat(row.cells[1].querySelector('input').value) || 0;
        const watts = parseFloat(row.cells[2].querySelector('input').value) || 0;
        const kDia = parseFloat(row.querySelector('.kwh-dia').innerText) || 0;
        const kMes = parseFloat(row.querySelector('.kwh-mes').innerText) || 0;
        
        totalW += (qty * watts);
        totalD += kDia;
        totalM += kMes;
    });
    
    // Actualizar los totales de la tabla
    document.getElementById('totalDia').innerText = totalD.toFixed(3);
    document.getElementById('totalMes').innerText = totalM.toFixed(2);
    
    // Actualizar el nuevo cuadro de resumen llamativo
    document.getElementById('totalWatts').innerText = totalW.toLocaleString(); // con separador de miles
    document.getElementById('resumenDia').innerText = totalD.toFixed(2);
    document.getElementById('resumenMes').innerText = totalM.toFixed(1);

    // Actualizar los campos del formulario (Capa de datos)
    document.getElementById('formWatts').value = totalW.toLocaleString() + " W";
    document.getElementById('formKwhMes').value = totalM.toFixed(2) + " kWh/mes";
}

    function removeRow(btn) {
        btn.closest('tr').remove();
        updateTotals();
    }

    window.onload = addRow;
// UNICA FUNCI√ìN PARA CALCULAR Y MOSTRAR RESULTADOS
function nextStep() {
    const hsp = parseFloat(document.getElementById('userRegion').value);
    if (!hsp) {
        alert("Por favor, selecciona tu regi√≥n para calcular.");
        return;
    }

    // 1. Datos de entrada
    const totalWattsCarga = parseFloat(document.getElementById('formWatts').value.replace(/[^0-9.]/g, '')) || 0;
    const kwhMes = parseFloat(document.getElementById('formKwhMes').value.replace(/[^0-9.]/g, '')) || 0;
    const kwhDia = kwhMes / 30;

    // 2. Inversor: Necesitamos al menos la carga m√°xima (Inversor 10kW base si es alto)
    const potenciaInversorKW = totalWattsCarga > 5000 ? 10 : 5; 
    const costoInversor = potenciaInversorKW === 10 ? 750000 : 450000;

    // 3. Paneles (590W a $90.000)
    const potenciaInstalarWp = (kwhDia / (hsp * 0.75)) * 1000;
    const numPaneles = Math.ceil(potenciaInstalarWp / 590);
    const costoPaneles = numPaneles * 100000;

    // 4. Bater√≠as (Basado en bloques de 10kWh a $1.500.000)
    const capacidadNecesaria = kwhDia * 1.2; // 1.2 d√≠as de autonom√≠a
    const numBaterias = Math.ceil(capacidadNecesaria / 10);
    const costoBaterias = numBaterias * 1500000;

    // 5. Otros costos fijos que mencionaste
    const estructura = 200000;
    const mppt = 1200000;
    const accesorios = 300000;
    const manoObra = 1500000; // Valor estimado de instalaci√≥n

    // 6. SUMA FINAL
    const costoNeto = costoPaneles + costoBaterias + costoInversor + estructura + mppt + accesorios + manoObra;
    const costoTotalConIva = costoNeto * 1.19;

    // ACTUALIZAR INTERFAZ
    document.getElementById('resInversor').innerText = potenciaInversorKW + " kW";
    document.getElementById('resPaneles').innerText = numPaneles + " Unidades";
    document.getElementById('resBaterias').innerText = (numBaterias * 10) + " kWh";
    document.getElementById('resCosto').innerText = "$" + Math.round(costoTotalConIva).toLocaleString('es-CL');

    document.getElementById('resultadoFinal').style.display = 'block';
    document.getElementById('btnPasoContacto').style.display = 'block';
    document.getElementById('resultadoFinal').scrollIntoView({ behavior: 'smooth' });
}

// Funci√≥n para mostrar el formulario de contacto
function mostrarContacto() {
    document.getElementById('contactoFinal').style.display = 'block';
    document.getElementById('contactoFinal').scrollIntoView({ behavior: 'smooth' });
}
// Nueva funci√≥n para mostrar el formulario final
function mostrarContacto() {
    document.getElementById('contactoFinal').style.display = 'block';
    document.getElementById('contactoFinal').scrollIntoView({ behavior: 'smooth' });
}

// Manejo del env√≠o del formulario
document.getElementById('leadForm').addEventListener('submit', function(e) {
    e.preventDefault();
    alert("¬°Muchas gracias! Hemos recibido tu solicitud. Un especialista se contactar√° contigo en el horario preferido.");
    // Aqu√≠ podr√≠as integrar el env√≠o real a tu correo o base de datos
});
const menuBtn = document.getElementById('mobile-menu');
const navList = document.getElementById('nav-list');

if (menuBtn && navList) {
    menuBtn.addEventListener('click', () => {
        navList.classList.toggle('active');
        const icon = menuBtn.querySelector('i');
        icon.classList.toggle('fa-bars');
        icon.classList.toggle('fa-times');
    });
}
</script>

</body>
</html>
